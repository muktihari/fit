// Code generated by internal/cmd/fitgen/main.go. DO NOT EDIT.
// SDK Version: 21.126

// Copyright 2023 The Fit SDK for Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

package mesgdef

import (
	"github.com/muktihari/fit/kit/typeconv"
	"github.com/muktihari/fit/profile/typedef"
	"github.com/muktihari/fit/proto"
)

// DeviceSettings is a DeviceSettings message.
type DeviceSettings struct {
	ActiveTimeZone                      uint8                 // Index into time zone arrays.
	UtcOffset                           uint32                // Offset from system time. Required to convert timestamp from system time to UTC.
	TimeOffset                          []uint32              // Array: [N]; Units: s; Offset from system time.
	TimeMode                            []typedef.TimeMode    // Array: [N]; Display mode for the time
	TimeZoneOffset                      []int8                // Scale: 4; Array: [N]; Units: hr; timezone offset in 1/4 hour increments
	BacklightMode                       typedef.BacklightMode // Mode for backlight
	ActivityTrackerEnabled              bool                  // Enabled state of the activity tracker functionality
	ClockTime                           typedef.DateTime      // UTC timestamp used to set the devices clock and date
	PagesEnabled                        []uint16              // Array: [N]; Bitfield to configure enabled screens for each supported loop
	MoveAlertEnabled                    bool                  // Enabled state of the move alert
	DateMode                            typedef.DateMode      // Display mode for the date
	DisplayOrientation                  typedef.DisplayOrientation
	MountingSide                        typedef.Side
	DefaultPage                         []uint16                   // Array: [N]; Bitfield to indicate one page as default for each supported loop
	AutosyncMinSteps                    uint16                     // Units: steps; Minimum steps before an autosync can occur
	AutosyncMinTime                     uint16                     // Units: minutes; Minimum minutes before an autosync can occur
	LactateThresholdAutodetectEnabled   bool                       // Enable auto-detect setting for the lactate threshold feature.
	BleAutoUploadEnabled                bool                       // Automatically upload using BLE
	AutoSyncFrequency                   typedef.AutoSyncFrequency  // Helps to conserve battery by changing modes
	AutoActivityDetect                  typedef.AutoActivityDetect // Allows setting specific activities auto-activity detect enabled/disabled settings
	NumberOfScreens                     uint8                      // Number of screens configured to display
	SmartNotificationDisplayOrientation typedef.DisplayOrientation // Smart Notification display orientation
	TapInterface                        typedef.Switch
	TapSensitivity                      typedef.TapSensitivity // Used to hold the tap threshold setting

	// Developer Fields are dynamic, can't be mapped as struct's fields.
	// [Added since protocol version 2.0]
	DeveloperFields []proto.DeveloperField
}

// NewDeviceSettings creates new DeviceSettings struct based on given mesg. If mesg is nil or mesg.Num is not equal to DeviceSettings mesg number, it will return nil.
func NewDeviceSettings(mesg proto.Message) *DeviceSettings {
	if mesg.Num != typedef.MesgNumDeviceSettings {
		return nil
	}

	vals := [...]any{ // nil value will be converted to its corresponding invalid value by typeconv.
		0:   nil, /* ActiveTimeZone */
		1:   nil, /* UtcOffset */
		2:   nil, /* TimeOffset */
		4:   nil, /* TimeMode */
		5:   nil, /* TimeZoneOffset */
		12:  nil, /* BacklightMode */
		36:  nil, /* ActivityTrackerEnabled */
		39:  nil, /* ClockTime */
		40:  nil, /* PagesEnabled */
		46:  nil, /* MoveAlertEnabled */
		47:  nil, /* DateMode */
		55:  nil, /* DisplayOrientation */
		56:  nil, /* MountingSide */
		57:  nil, /* DefaultPage */
		58:  nil, /* AutosyncMinSteps */
		59:  nil, /* AutosyncMinTime */
		80:  nil, /* LactateThresholdAutodetectEnabled */
		86:  nil, /* BleAutoUploadEnabled */
		89:  nil, /* AutoSyncFrequency */
		90:  nil, /* AutoActivityDetect */
		94:  nil, /* NumberOfScreens */
		95:  nil, /* SmartNotificationDisplayOrientation */
		134: nil, /* TapInterface */
		174: nil, /* TapSensitivity */
	}

	for i := range mesg.Fields {
		field := &mesg.Fields[i]
		if field.Num >= byte(len(vals)) {
			continue
		}
		vals[field.Num] = field.Value
	}

	return &DeviceSettings{
		ActiveTimeZone:                      typeconv.ToUint8[uint8](vals[0]),
		UtcOffset:                           typeconv.ToUint32[uint32](vals[1]),
		TimeOffset:                          typeconv.ToSliceUint32[uint32](vals[2]),
		TimeMode:                            typeconv.ToSliceEnum[typedef.TimeMode](vals[4]),
		TimeZoneOffset:                      typeconv.ToSliceSint8[int8](vals[5]),
		BacklightMode:                       typeconv.ToEnum[typedef.BacklightMode](vals[12]),
		ActivityTrackerEnabled:              typeconv.ToBool[bool](vals[36]),
		ClockTime:                           typeconv.ToUint32[typedef.DateTime](vals[39]),
		PagesEnabled:                        typeconv.ToSliceUint16[uint16](vals[40]),
		MoveAlertEnabled:                    typeconv.ToBool[bool](vals[46]),
		DateMode:                            typeconv.ToEnum[typedef.DateMode](vals[47]),
		DisplayOrientation:                  typeconv.ToEnum[typedef.DisplayOrientation](vals[55]),
		MountingSide:                        typeconv.ToEnum[typedef.Side](vals[56]),
		DefaultPage:                         typeconv.ToSliceUint16[uint16](vals[57]),
		AutosyncMinSteps:                    typeconv.ToUint16[uint16](vals[58]),
		AutosyncMinTime:                     typeconv.ToUint16[uint16](vals[59]),
		LactateThresholdAutodetectEnabled:   typeconv.ToBool[bool](vals[80]),
		BleAutoUploadEnabled:                typeconv.ToBool[bool](vals[86]),
		AutoSyncFrequency:                   typeconv.ToEnum[typedef.AutoSyncFrequency](vals[89]),
		AutoActivityDetect:                  typeconv.ToUint32[typedef.AutoActivityDetect](vals[90]),
		NumberOfScreens:                     typeconv.ToUint8[uint8](vals[94]),
		SmartNotificationDisplayOrientation: typeconv.ToEnum[typedef.DisplayOrientation](vals[95]),
		TapInterface:                        typeconv.ToEnum[typedef.Switch](vals[134]),
		TapSensitivity:                      typeconv.ToEnum[typedef.TapSensitivity](vals[174]),

		DeveloperFields: mesg.DeveloperFields,
	}
}

// PutMessage puts fields's value into mesg. If mesg is nil or mesg.Num is not equal to DeviceSettings mesg number, it will return nil.
// It is the caller responsibility to provide the appropriate mesg, it's recommended to create mesg using factory:
//
//	factory.CreateMesg(typedef.MesgNumDeviceSettings)
func (m *DeviceSettings) PutMessage(mesg *proto.Message) {
	if mesg == nil {
		return
	}

	if mesg.Num != typedef.MesgNumDeviceSettings {
		return
	}

	vals := [...]any{
		0:   m.ActiveTimeZone,
		1:   m.UtcOffset,
		2:   m.TimeOffset,
		4:   typeconv.ToSliceEnum[byte](m.TimeMode),
		5:   m.TimeZoneOffset,
		12:  typeconv.ToEnum[byte](m.BacklightMode),
		36:  m.ActivityTrackerEnabled,
		39:  typeconv.ToUint32[uint32](m.ClockTime),
		40:  m.PagesEnabled,
		46:  m.MoveAlertEnabled,
		47:  typeconv.ToEnum[byte](m.DateMode),
		55:  typeconv.ToEnum[byte](m.DisplayOrientation),
		56:  typeconv.ToEnum[byte](m.MountingSide),
		57:  m.DefaultPage,
		58:  m.AutosyncMinSteps,
		59:  m.AutosyncMinTime,
		80:  m.LactateThresholdAutodetectEnabled,
		86:  m.BleAutoUploadEnabled,
		89:  typeconv.ToEnum[byte](m.AutoSyncFrequency),
		90:  typeconv.ToUint32[uint32](m.AutoActivityDetect),
		94:  m.NumberOfScreens,
		95:  typeconv.ToEnum[byte](m.SmartNotificationDisplayOrientation),
		134: typeconv.ToEnum[byte](m.TapInterface),
		174: typeconv.ToEnum[byte](m.TapSensitivity),
	}

	for i := range mesg.Fields {
		field := &mesg.Fields[i]
		if field.Num >= byte(len(vals)) {
			continue
		}
		field.Value = vals[field.Num]
	}

	mesg.DeveloperFields = m.DeveloperFields
}
